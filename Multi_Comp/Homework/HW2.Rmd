---
title: 'Multiple Comparisons: Homework - 2'
output:
  pdf_document: default
  github_document: 
    pandoc_args: --webtex
  html_notebook: default
---


Submitted by: 
=============

Eyal Bar-Natan - 207630658

Omer Shubi - 312236219


# Question 1


## Part A


We perform $iterations=5,000$ simulations, in which each time we randomly pick $m=5$ values out a Uniform Distribution ($U\sim Uni[0,1]$).
In each simulation, out of the picked values we select the one with the minimum value. The result of these simulations is stored in $vecmin\_m$.

 
```{r}
iterations <- 5000
```

```{r}
m <- 5
mat_5 <- replicate(iterations, runif(m,0, 1))
vecmin_5 <- apply(mat_5, 2, min)
```

and similarly with $m=20$:

```{r}
m <- 20
mat_20 <- replicate(iterations, runif(m,0, 1))
vecmin_20 <- apply(mat_20, 2, min)
```

and $m=100$:

```{r}
m <- 100
mat_100 <- replicate(iterations, runif(m,0, 1))
vecmin_100 <- apply(mat_100, 2, min)
```

### 1.

The proportion of $U_{(1)}<0.05$ when $m=5$:

```{r}
length(vecmin_5[vecmin_5<0.05])/iterations
```

Similarly to section $\aleph$ in H.W. 1 - in which $p_{value}\sim Uni[0,1]$, and we were requested to retrieve the minimal $p_{value}$.

This is exactly what we are asked to find in this question as well, 
by defining $U_i={p_{value}}_i\sim Uni[0,1]$ and $U_{(1)} = min(U_1,U_2,\ldots,U_m)$
we are dealing with the same thing.

### 2.

Histogram of $U_{(1)}$ with $m=5$:
```{r}
hist(vecmin_5, xlim=c(0,1))
```
Histogram of $U_{i}$ with $m=5$:

```{r}
hist(mat_5, xlim=c(0,1))
```


By running the ecdf function we can visual the cdf of both functions clearly. 

```{r}
plot(ecdf(vecmin_5),col='red', main='CDF of Uni[0,1] and U(1)', xlim=c(0,1))
lines(ecdf(mat_5),col='green')
legend(0, 1, legend=c(expression(U[(1)]), 'Uni[0,1]'), col=c("red", "green"), lty=1, cex=0.8)
```
As can be seen from both the histograms and the cdf functions,

it is clear that $U_{(1)}$ is stochastically smaller ($\prec$) than $Uni[0,1]$.

### 3.


Histogram of $U_{(1)}$ with $m=5$:

```{r}
hist(vecmin_5, xlim=c(0,1))
```
Histogram of $U_{(1)}$ with $m=20$:

```{r}
hist(vecmin_20, breaks = 20, xlim=c(0,1))
```
Histogram of $U_{(1)}$ with $m=100$:

```{r}
hist(vecmin_100, xlim=c(0,1))
```

```{r}
plot(ecdf(vecmin_5),col='red', main='CDF of U(1) with different m values', xlim=c(0,0.65))
lines(ecdf(vecmin_20),col='green')
lines(ecdf(vecmin_100),col='blue')

legend(0.5, 0.5, legend=c(expression(U[(1)],widehat(U[(1)]),widetilde(U[(1)]))), col=c("red", "green", "blue"), lty=1)
```
$U_{(1)}$ is with $m=5$, $\widehat U_{(1)}$ is with $m=20$ and $\widetilde U_{(1)}$ is with $m=100$.

It can be clearly observed that:

if $m > m'$  then $U_{(1)} \prec U_{(1)}'$

if $m < m'$  then $U_{(1)} \succ U_{(1)}'$


## Part B.


add proof from Eyal of 2 & 3

$U_{(1)}\prec U_i \iff P(U_{(1)}\leq a) \geq P(U_i\leq a)$





$U_{(1)} \sim Beta(1,m)$ therefore has the same cdf of Beta(1,m).

## Part C.

Add function that we found

## Part D.

Add r.v. that we found

## Part E.


```{r}
Y <- 1-(1-vecmin_100)^100
hist(Y)
```
For $Y=1-(1-U_{(1)})^m$,

as can be seen, the random variable $Y$ that we found , holds $Y\sim Uni[0,1]$ as expected.

## Part F.

### 1.

This corresponds exactly to the function we found in part C:

$p_{value}^{adj}=1-(1-P_{value})^{\frac{1}{m}}$

where $m$ is the total number of courses (because $m=m_0$ according to the question assumptions).

So for $p_{value}=0.05$ we get:

$p_{value}^{adj}=1-(1-0.05)^{\frac{1}{m}} = 1-(0.95)^{\frac{1}{m}}$ 

As we showed and proved in previous sections, this equation is provides the adjusted pvalue, as desired. 




